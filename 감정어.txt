<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì•Œë¡ë‹¬ë¡ ë§ˆìŒ ì‚¬ì „</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        /* í”Œë˜ì‹œì¹´ë“œ ë’¤ì§‘ê¸° ì• ë‹ˆë©”ì´ì…˜ */
        .card {
            transform-style: preserve-3d;
            transition: transform 0.6s;
        }
        .card.is-flipped {
            transform: rotateY(180deg);
        }
        .card-face {
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
        }
        .card-face-back {
            transform: rotateY(180deg);
        }
    </style>
</head>
<body class="bg-yellow-50 flex flex-col items-center justify-center min-h-screen p-4">

    <div id="app" class="w-full max-w-md mx-auto bg-white rounded-2xl shadow-lg p-6">
        <header class="text-center mb-6">
            <h1 class="text-3xl font-bold text-yellow-500">ğŸŒˆ ì•Œë¡ë‹¬ë¡ ë§ˆìŒ ì‚¬ì „</h1>
            <p class="text-gray-500 mt-1">ì˜¤ëŠ˜ì€ ì–´ë–¤ ë§ˆìŒì„ ë°°ì› ì„ê¹Œ?</p>
        </header>

        <!-- ì§„í–‰ ìƒí™© í‘œì‹œ -->
        <div id="progress-container" class="mb-6">
            <p class="text-lg font-semibold text-center text-gray-700">ì˜¤ëŠ˜ì˜ í•™ìŠµé€²åº¦</p>
            <div class="w-full bg-gray-200 rounded-full h-4 mt-2">
                <div id="progress-bar" class="bg-green-400 h-4 rounded-full transition-all duration-500" style="width: 0%;"></div>
            </div>
            <p id="progress-text" class="text-center text-sm text-gray-500 mt-1">0 / 0</p>
        </div>

        <!-- í•™ìŠµ ì„ íƒ ë©”ë‰´ -->
        <nav id="menu" class="flex justify-around mb-6">
            <button data-mode="flashcard" class="menu-btn bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-transform transform hover:scale-105">í”Œë˜ì‹œì¹´ë“œ</button>
            <button data-mode="quiz" class="menu-btn bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-transform transform hover:scale-105">ë§ˆìŒ í€´ì¦ˆ</button>
            <button data-mode="sentence" class="menu-btn bg-pink-500 hover:bg-pink-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-transform transform hover:scale-105">ë¬¸ì¥ ì™„ì„±</button>
        </nav>

        <!-- í•™ìŠµ ì½˜í…ì¸  ì˜ì—­ -->
        <main id="content-area" class="min-h-[300px] flex items-center justify-center">
            <!-- ì´ˆê¸° í™”ë©´ -->
            <div id="welcome-screen" class="text-center">
                <p class="text-xl font-semibold text-gray-600">ë¬´ì—‡ì„ ë¨¼ì € ë°°ì›Œë³¼ê¹Œìš”?</p>
                <p class="text-gray-500 mt-2">ìœ„ ë²„íŠ¼ì„ ëˆŒëŸ¬ í•™ìŠµì„ ì‹œì‘í•˜ì„¸ìš”!</p>
            </div>
            <!-- í”Œë˜ì‹œì¹´ë“œ -->
            <div id="flashcard-container" class="hidden w-full perspective-[1000px]"></div>
            <!-- í€´ì¦ˆ -->
            <div id="quiz-container" class="hidden w-full"></div>
            <!-- ë¬¸ì¥ ì™„ì„± -->
            <div id="sentence-container" class="hidden w-full"></div>
        </main>

        <!-- ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ -->
        <div id="navigation-controls" class="flex justify-between mt-6 hidden">
            <button id="prev-btn" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-lg transition">ì´ì „</button>
            <button id="next-btn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg transition">ë‹¤ìŒ</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- ë°ì´í„° ì˜ì—­ ---
            // ì´ˆë“±í•™êµ 1í•™ë…„ ìˆ˜ì¤€ì˜ ê°ì • ì–´íœ˜ ëª©ë¡ (ì´ 28ê°œ, 4ì£¼ ë¶„ëŸ‰)
            const ALL_WORDS = [
                { word: 'ê¸°ì¨', definition: 'ë§¤ìš° ì¢‹ê³  ì¦ê±°ìš´ ë§ˆìŒì´ë‚˜ ëŠë‚Œ', sentence: 'ì„ ë¬¼ì„ ë°›ì•„ì„œ [ ]ì´ ë„˜ì³¤ì–´ìš”.' },
                { word: 'ìŠ¬í””', definition: 'ë§ˆìŒì´ ì•„í”„ê³  ê´´ë¡œìš´ ëŠë‚Œ', sentence: 'ì¹œêµ¬ê°€ ì´ì‚¬ë¥¼ ê°€ì„œ [ ]ì— ì ê²¼ì–´ìš”.' },
                { word: 'í™”ë‚¨', definition: 'ëª¹ì‹œ ëª»ë§ˆë•…í•˜ê±°ë‚˜ ì–¸ì§¢ì€ ê°ì •', sentence: 'ë™ìƒì´ ë‚´ ì¥ë‚œê°ì„ ë§ê°€ëœ¨ë ¤ì„œ [ ]ì´ ë‚¬ì–´ìš”.' },
                { word: 'í–‰ë³µ', definition: 'ìƒí™œì—ì„œ ì¶©ë¶„í•œ ë§Œì¡±ê³¼ ê¸°ì¨ì„ ëŠë¼ëŠ” ìƒíƒœ', sentence: 'ê°€ì¡±ê³¼ í•¨ê»˜ ìˆì„ ë•Œ ê°€ì¥ [ ]í•´ìš”.' },
                { word: 'ë¬´ì„œì›€', definition: 'ìœ„í—˜ì„ ëŠë¼ê±°ë‚˜ ê²ì´ ë‚˜ëŠ” ëŠë‚Œ', sentence: 'ì–´ë‘ìš´ ë°¤ í˜¼ì ìˆìœ¼ë©´ [ ]ì„ ëŠê»´ìš”.' },
                { word: 'ë†€ëŒ', definition: 'ì˜ˆìƒí•˜ì§€ ëª»í•œ ì¼ì„ ë‹¹í•´ ê°€ìŠ´ì´ ë›°ëŠ” ëŠë‚Œ', sentence: 'ê°‘ìê¸° ì¹œêµ¬ê°€ ë‚˜íƒ€ë‚˜ì„œ ê¹œì§ [ ]í–ˆì–´ìš”.' },
                { word: 'ì‹ ë‚¨', definition: 'í¥ë¶„ë˜ê³  ê¸°ë¶„ì´ ì¢‹ì€ ìƒíƒœ', sentence: 'ì†Œí’ ê°€ëŠ” ë‚ ì´ë¼ ë¬´ì²™ [ ]ì´ ë‚¬ì–´ìš”.' },
                
                { word: 'ì‚¬ë‘', definition: 'ì–´ë–¤ ì‚¬ëŒì´ë‚˜ ì¡´ì¬ë¥¼ ì•„ë¼ê³  ì†Œì¤‘íˆ ì—¬ê¸°ëŠ” ë§ˆìŒ', sentence: 'ë‚˜ëŠ” ìš°ë¦¬ ì—„ë§ˆ ì•„ë¹ ë¥¼ [ ]í•´ìš”.' },
                { word: 'ë¯¸ì›€', definition: 'ì–´ë–¤ ê²ƒì„ ì‹«ì–´í•˜ê³  ë°‰ê²Œ ì—¬ê¸°ëŠ” ê°ì •', sentence: 'ê±°ì§“ë§í•˜ëŠ” ì¹œêµ¬ì—ê²Œ [ ]ì´ ìƒê²¼ì–´ìš”.' },
                { word: 'ê±±ì •', definition: 'ì¼ì´ ì˜ëª»ë ê¹Œ ë´ ë¶ˆì•ˆí•˜ê³  ì´ˆì¡°í•œ ë§ˆìŒ', sentence: 'ì‹œí—˜ì„ ì˜ ëª» ë³¼ê¹Œ ë´ [ ]ì´ ë¼ìš”.' },
                { word: 'í¸ì•ˆí•¨', definition: 'ëª¸ì´ë‚˜ ë§ˆìŒì´ ì•„ë¬´ ê±±ì • ì—†ì´ ì¢‹ì€ ìƒíƒœ', sentence: 'ì§‘ì— ì˜¤ë©´ ë§ˆìŒì´ [ ]ì„ ëŠê»´ìš”.' },
                { word: 'ë¶€ë„ëŸ¬ì›€', definition: 'ì˜ëª»í•˜ê±°ë‚˜ ì°½í”¼í•´ì„œ ì–¼êµ´ì„ ë“¤ê¸° ì–´ë ¤ìš´ ëŠë‚Œ', sentence: 'ë§ì€ ì‚¬ëŒ ì•ì—ì„œ ë…¸ë˜ë¥¼ ë¶€ë¥´ë ¤ë‹ˆ [ ]ì´ ë§ì•˜ì–´ìš”.' },
                { word: 'ê¶ê¸ˆí•¨', definition: 'ì•Œê³  ì‹¶ê±°ë‚˜ ë³´ê³  ì‹¶ì–´ì„œ ë§ˆìŒì´ ëŒë¦¬ëŠ” ëŠë‚Œ', sentence: 'ìƒì ì•ˆì— ë¬´ì—‡ì´ ë“¤ì—ˆì„ì§€ [ ]ì´ ìƒê²¼ì–´ìš”.' },
                { word: 'ì™¸ë¡œì›€', definition: 'í˜¼ì ìˆëŠ” ê²ƒ ê°™ì•„ ì“¸ì“¸í•œ ë§ˆìŒ', sentence: 'ì•„ë¬´ë„ ê°™ì´ ë†€ì•„ì£¼ì§€ ì•Šì•„ì„œ [ ]ì„ ëŠê¼ˆì–´ìš”.' },

                { word: 'ìë‘ìŠ¤ëŸ¬ì›€', definition: 'ìì‹ ì´ë‚˜ ë‹¤ë¥¸ ì‚¬ëŒì˜ ì¢‹ì€ ì ì„ ë½ë‚´ê³  ì‹¶ì€ ë§ˆìŒ', sentence: 'ë‹¬ë¦¬ê¸°ì—ì„œ 1ë“±ì„ í•´ì„œ [ ]ì„ ëŠê¼ˆì–´ìš”.' },
                { word: 'ê³ ë§ˆì›€', definition: 'ë‹¤ë¥¸ ì‚¬ëŒì´ ë² í‘¼ ë„ì›€ì— ëŒ€í•´ ê°ì‚¬í•˜ê²Œ ì—¬ê¸°ëŠ” ë§ˆìŒ', sentence: 'ì¹œêµ¬ê°€ ë‚˜ë¥¼ ë„ì™€ì¤˜ì„œ [ ]ì„ í‘œí˜„í–ˆì–´ìš”.' },
                { word: 'ì‹¤ë§', definition: 'ê¸°ëŒ€í–ˆë˜ ì¼ì´ ì´ë£¨ì–´ì§€ì§€ ì•Šì•„ ë§ˆìŒì´ ìƒí•˜ëŠ” ê²ƒ', sentence: 'ê°–ê³  ì‹¶ë˜ ì„ ë¬¼ì„ ëª» ë°›ì•„ì„œ [ ]í–ˆì–´ìš”.' },
                { word: 'ë‹µë‹µí•¨', definition: 'ì¼ì´ ëœ»ëŒ€ë¡œ ë˜ì§€ ì•Šì•„ ë§ˆìŒì´ ì‹œì›í•˜ì§€ ì•Šì€ ëŠë‚Œ', sentence: 'ë¬¸ì œê°€ í’€ë¦¬ì§€ ì•Šì•„ì„œ ë§ˆìŒì´ [ ]ì„ ëŠê¼ˆì–´ìš”.' },
                { word: 'ì‹¬ì‹¬í•¨', definition: 'í•  ì¼ì´ ì—†ì–´ì„œ ì§€ë£¨í•˜ê³  ì¬ë¯¸ì—†ëŠ” ëŠë‚Œ', sentence: 'ì£¼ë§ì— ì•„ë¬´ ì•½ì†ì´ ì—†ì–´ì„œ [ ]ì„ ëŠê¼ˆì–´ìš”.' },
                { word: 'ì„¤ë ˜', definition: 'ì¢‹ì€ ì¼ì´ ìƒê¸¸ ê²ƒ ê°™ì•„ ë§ˆìŒì´ ë“¤ëœ¨ëŠ” ê¸°ë¶„', sentence: 'ë‚´ì¼ ìƒì¼ì´ë¼ ë§ˆìŒì— [ ]ì´ ê°€ë“í•´ìš”.' },
                { word: 'ë¿Œë“¯í•¨', definition: 'ì–´ë ¤ìš´ ì¼ì„ í•´ëƒˆì„ ë•Œ ëŠë¼ëŠ” ë§Œì¡±ìŠ¤ëŸ¬ìš´ ê¸°ë¶„', sentence: 'ë°© ì²­ì†Œë¥¼ ë‹¤ ëë‚´ê³  ë‚˜ë‹ˆ [ ]ì„ ëŠê¼ˆì–´ìš”.' },

                { word: 'ì•ˆì‹¬', definition: 'ê±±ì •ì´ ì‚¬ë¼ì§€ê³  ë§ˆìŒì´ ë†“ì´ëŠ” ìƒíƒœ', sentence: 'ìƒì–´ë²„ë¦° ê°•ì•„ì§€ë¥¼ ì°¾ì•„ì„œ [ ]ì´ ë˜ì—ˆì–´ìš”.' },
                { word: 'ì–µìš¸í•¨', definition: 'ì•„ë¬´ ì˜ëª» ì—†ì´ ê¾¸ì¤‘ì„ ë“¤ì–´ ëŠë¼ëŠ” ë‹µë‹µí•œ ë§ˆìŒ', sentence: 'ë‚´ê°€ í•˜ì§€ ì•Šì€ ì¼ë¡œ í˜¼ë‚˜ì„œ [ ]ì„ ëŠê¼ˆì–´ìš”.' },
                { word: 'ê°ë™', definition: 'í¬ê²Œ ë§ˆìŒì´ ì›€ì§ì—¬ì„œ ëŠë¼ëŠ” ë²…ì°¬ ê¸°ë¶„', sentence: 'ì¹œêµ¬ì˜ í¸ì§€ë¥¼ ì½ê³  í° [ ]ì„ ë°›ì•˜ì–´ìš”.' },
                { word: 'ì§ˆíˆ¬', definition: 'ë‹¤ë¥¸ ì‚¬ëŒì´ ë‚˜ë³´ë‹¤ ì˜ë˜ëŠ” ê²ƒì„ ë¶€ëŸ¬ì›Œí•˜ê³  ë¯¸ì›Œí•˜ëŠ” ë§ˆìŒ', sentence: 'ì¹œêµ¬ê°€ ìƒˆ ì¥ë‚œê°ì„ ë°›ì•„ì„œ [ ]ê°€ ë‚¬ì–´ìš”.' },
                { word: 'ì¦ê±°ì›€', definition: 'ìœ ì¾Œí•˜ê³  ê¸°ìœ ë§ˆìŒì´ë‚˜ ëŠë‚Œ', sentence: 'ì¹œêµ¬ë“¤ê³¼ í•¨ê»˜ ë…¸ëŠ” ê²ƒì€ í° [ ]ì´ì—ìš”.' },
                { word: 'ë‹¹í™©', definition: 'ëœ»ë°–ì˜ ì¼ì„ ë§Œë‚˜ ì–´ì©” ì¤„ ëª¨ë¥´ëŠ” ìƒíƒœ', sentence: 'ê¸¸ì„ ìƒì–´ë²„ë ¤ì„œ ë¬´ì²™ [ ]í–ˆì–´ìš”.' },
                { word: 'íë­‡í•¨', definition: 'ë§ˆìŒì— ë“¤ì–´ ë§Œì¡±ìŠ¤ëŸ¬ìš´ ê¸°ë¶„', sentence: 'ë™ìƒì´ ì°©í•œ ì¼ì„ í•˜ëŠ” ê²ƒì„ ë³´ë‹ˆ ë§ˆìŒì´ [ ]í–ˆì–´ìš”.' },
            ];
            const WORDS_PER_WEEK = 7;

            // --- ìƒíƒœ ê´€ë¦¬ ---
            let currentMode = ''; // 'flashcard', 'quiz', 'sentence'
            let weeklyWords = [];
            let currentIndex = 0;
            let progress = {}; // { 'ê¸°ì¨': true, 'ìŠ¬í””': false, ... }

            // --- í—¬í¼ í•¨ìˆ˜ ---
            // ì˜¬í•´ì˜ ëª‡ ë²ˆì§¸ ì£¼ì¸ì§€ ê³„ì‚° (ì›”ìš”ì¼ ê¸°ì¤€)
            const getWeekNumber = () => {
                const today = new Date();
                const firstDayOfYear = new Date(today.getFullYear(), 0, 1);
                const pastDaysOfYear = (today - firstDayOfYear) / 86400000;
                return Math.ceil((pastDaysOfYear + firstDayOfYear.getDay() + 1) / 7);
            };

            // ì˜¤ëŠ˜ ë‚ ì§œë¥¼ 'YYYY-MM-DD' í˜•ì‹ìœ¼ë¡œ ê°€ì ¸ì˜¤ê¸°
            const getTodayDateString = () => {
                return new Date().toISOString().split('T')[0];
            };

            // --- ë°ì´í„° ë¡œë”© ë° ì €ì¥ ---
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ì§„í–‰ ìƒí™© ë¶ˆëŸ¬ì˜¤ê¸°
            const loadProgress = () => {
                const today = getTodayDateString();
                const savedProgress = JSON.parse(localStorage.getItem('emotionVocabProgress'));
                if (savedProgress && savedProgress[today]) {
                    progress = savedProgress[today];
                } else {
                    // ì˜¤ëŠ˜ ì²˜ìŒ ì ‘ì†í–ˆìœ¼ë©´ ì´ˆê¸°í™”
                    weeklyWords.forEach(wordObj => {
                        progress[wordObj.word] = false;
                    });
                }
            };

            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì§„í–‰ ìƒí™© ì €ì¥í•˜ê¸°
            const saveProgress = () => {
                const today = getTodayDateString();
                let savedProgress = JSON.parse(localStorage.getItem('emotionVocabProgress')) || {};
                savedProgress[today] = progress;
                localStorage.setItem('emotionVocabProgress', JSON.stringify(savedProgress));
                updateProgressView();
            };

            // --- UI ë Œë”ë§ í•¨ìˆ˜ ---
            // ì§„í–‰ ìƒí™© UI ì—…ë°ì´íŠ¸
            const updateProgressView = () => {
                const learnedCount = Object.values(progress).filter(Boolean).length;
                const totalCount = weeklyWords.length;
                const progressBar = document.getElementById('progress-bar');
                const progressText = document.getElementById('progress-text');

                if (totalCount > 0) {
                    const percentage = (learnedCount / totalCount) * 100;
                    progressBar.style.width = `${percentage}%`;
                    progressText.textContent = `${learnedCount} / ${totalCount}`;
                }
            };

            // í”Œë˜ì‹œì¹´ë“œ ë Œë”ë§
            const renderFlashcard = () => {
                const wordObj = weeklyWords[currentIndex];
                const container = document.getElementById('flashcard-container');
                container.innerHTML = `
                    <div class="card w-full h-72 cursor-pointer" onclick="this.classList.toggle('is-flipped')">
                        <div class="card-face absolute w-full h-full flex items-center justify-center bg-blue-300 rounded-xl shadow-lg">
                            <p class="text-5xl font-bold text-white">${wordObj.word}</p>
                        </div>
                        <div class="card-face card-face-back absolute w-full h-full flex flex-col items-center justify-center bg-blue-500 rounded-xl shadow-lg p-4">
                            <p class="text-2xl font-bold text-white">${wordObj.definition}</p>
                        </div>
                    </div>
                    <div class="text-center mt-4">
                        <button id="mark-learned-btn" class="py-2 px-4 rounded-lg text-white font-semibold ${progress[wordObj.word] ? 'bg-gray-400' : 'bg-green-500 hover:bg-green-600'}">
                            ${progress[wordObj.word] ? 'ë‹¤ ì•„ëŠ” ë‹¨ì–´ì˜ˆìš”' : 'ì´ì œ ì•Œì•˜ì–´ìš”!'}
                        </button>
                    </div>
                `;
                document.getElementById('mark-learned-btn').addEventListener('click', (e) => {
                    e.stopPropagation(); // ì¹´ë“œê°€ ë’¤ì§‘íˆì§€ ì•Šë„ë¡
                    if (!progress[wordObj.word]) {
                        progress[wordObj.word] = true;
                        saveProgress();
                        renderFlashcard(); // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•´ ë‹¤ì‹œ ë Œë”ë§
                    }
                });
            };

            // í€´ì¦ˆ ë Œë”ë§
            const renderQuiz = () => {
                const wordObj = weeklyWords[currentIndex];
                const container = document.getElementById('quiz-container');

                // ì˜¤ë‹µ ì„ íƒì§€ ë§Œë“¤ê¸°
                let options = [wordObj];
                while (options.length < 4) {
                    const randomWord = weeklyWords[Math.floor(Math.random() * weeklyWords.length)];
                    if (!options.some(opt => opt.word === randomWord.word)) {
                        options.push(randomWord);
                    }
                }
                // ì„ íƒì§€ ì„ê¸°
                options.sort(() => Math.random() - 0.5);

                container.innerHTML = `
                    <div class="text-center">
                        <p class="text-4xl font-bold text-purple-600 mb-6">${wordObj.word}</p>
                        <p class="text-lg text-gray-600 mb-6">ì´ ë‹¨ì–´ì˜ ëœ»ì€ ë¬´ì—‡ì¼ê¹Œìš”?</p>
                        <div class="grid grid-cols-2 gap-4">
                            ${options.map(opt => `
                                <button class="quiz-option p-4 bg-purple-100 rounded-lg text-purple-800 hover:bg-purple-200 transition" data-word="${opt.word}">
                                    ${opt.definition}
                                </button>
                            `).join('')}
                        </div>
                    </div>
                `;

                container.querySelectorAll('.quiz-option').forEach(button => {
                    button.addEventListener('click', () => {
                        const isCorrect = button.dataset.word === wordObj.word;
                        const resultDiv = document.createElement('div');
                        resultDiv.className = `mt-4 p-3 rounded-lg text-center font-bold text-white ${isCorrect ? 'bg-green-500' : 'bg-red-500'}`;
                        resultDiv.textContent = isCorrect ? 'ì •ë‹µì´ì—ìš”! ğŸ‰' : 'ì•„ì‰¬ì›Œìš”, ë‹¤ì‹œ ìƒê°í•´ë´ìš”!';
                        container.appendChild(resultDiv);

                        if (isCorrect) {
                            progress[wordObj.word] = true;
                            saveProgress();
                        }
                        // 1.5ì´ˆ í›„ ë‹¤ìŒ ë¬¸ì œë¡œ (ë˜ëŠ” ê²°ê³¼ ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°)
                        setTimeout(() => {
                            if (isCorrect) {
                                goToNext();
                            } else {
                                resultDiv.remove();
                            }
                        }, 1500);
                    });
                });
            };

            // ë¬¸ì¥ ì™„ì„± ë Œë”ë§
            const renderSentenceGame = () => {
                const wordObj = weeklyWords[currentIndex];
                const container = document.getElementById('sentence-container');

                let options = [wordObj];
                while (options.length < 4) {
                    const randomWord = weeklyWords[Math.floor(Math.random() * weeklyWords.length)];
                    if (!options.some(opt => opt.word === randomWord.word)) {
                        options.push(randomWord);
                    }
                }
                options.sort(() => Math.random() - 0.5);

                const sentenceHtml = wordObj.sentence.replace('[ ]', '<span class="inline-block w-24 h-8 bg-pink-200 rounded-md"></span>');

                container.innerHTML = `
                    <div class="text-center">
                        <p class="text-2xl font-semibold text-gray-700 mb-6 leading-relaxed">${sentenceHtml}</p>
                        <p class="text-lg text-gray-600 mb-6">ë¹ˆì¹¸ì— ë“¤ì–´ê°ˆ ì•Œë§ì€ ë§ì€ ë¬´ì—‡ì¼ê¹Œìš”?</p>
                        <div class="grid grid-cols-2 gap-4">
                            ${options.map(opt => `
                                <button class="sentence-option p-4 bg-pink-100 rounded-lg text-pink-800 hover:bg-pink-200 transition" data-word="${opt.word}">
                                    ${opt.word}
                                </button>
                            `).join('')}
                        </div>
                    </div>
                `;

                container.querySelectorAll('.sentence-option').forEach(button => {
                    button.addEventListener('click', () => {
                        const isCorrect = button.dataset.word === wordObj.word;
                        const resultDiv = document.createElement('div');
                        resultDiv.className = `mt-4 p-3 rounded-lg text-center font-bold text-white ${isCorrect ? 'bg-green-500' : 'bg-red-500'}`;
                        resultDiv.textContent = isCorrect ? 'ì°¸ ì˜í–ˆì–´ìš”! ğŸŒŸ' : 'ì¡°ê¸ˆ ë” ìƒê°í•´ë³¼ê¹Œìš”?';
                        container.appendChild(resultDiv);

                        if (isCorrect) {
                            progress[wordObj.word] = true;
                            saveProgress();
                        }
                        setTimeout(() => {
                            if (isCorrect) {
                                goToNext();
                            } else {
                                resultDiv.remove();
                            }
                        }, 1500);
                    });
                });
            };

            // --- í™”ë©´ ì „í™˜ ë° ì œì–´ ---
            const switchMode = (mode) => {
                currentMode = mode;
                currentIndex = 0;

                // ëª¨ë“  í™”ë©´ ìˆ¨ê¸°ê¸°
                document.getElementById('welcome-screen').classList.add('hidden');
                document.getElementById('flashcard-container').classList.add('hidden');
                document.getElementById('quiz-container').classList.add('hidden');
                document.getElementById('sentence-container').classList.add('hidden');
                
                // ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ í‘œì‹œ
                document.getElementById('navigation-controls').classList.remove('hidden');

                renderContent();
            };

            const renderContent = () => {
                if (currentMode === 'flashcard') {
                    document.getElementById('flashcard-container').classList.remove('hidden');
                    renderFlashcard();
                } else if (currentMode === 'quiz') {
                    document.getElementById('quiz-container').classList.remove('hidden');
                    renderQuiz();
                } else if (currentMode === 'sentence') {
                    document.getElementById('sentence-container').classList.remove('hidden');
                    renderSentenceGame();
                }
                updateNavButtons();
            };

            const updateNavButtons = () => {
                document.getElementById('prev-btn').disabled = currentIndex === 0;
                document.getElementById('next-btn').disabled = currentIndex === weeklyWords.length - 1;
            };

            const goToPrev = () => {
                if (currentIndex > 0) {
                    currentIndex--;
                    renderContent();
                }
            };

            const goToNext = () => {
                if (currentIndex < weeklyWords.length - 1) {
                    currentIndex++;
                    renderContent();
                } else {
                    // ë§ˆì§€ë§‰ ë‹¨ì–´ í•™ìŠµ ì™„ë£Œ
                    const contentArea = document.getElementById('content-area');
                    contentArea.innerHTML = `
                        <div class="text-center p-8 bg-green-100 rounded-xl">
                            <h2 class="text-2xl font-bold text-green-700">ì°¸ ì˜í–ˆì–´ìš”!</h2>
                            <p class="mt-2 text-gray-600">ì´ë²ˆ ì£¼ ë‹¨ì–´ í•™ìŠµì„ ëª¨ë‘ ë§ˆì³¤ì–´ìš”!</p>
                            <p class="mt-1 text-gray-600">ë‹¤ë¥¸ í•™ìŠµë„ í•´ë³´ì„¸ìš”.</p>
                        </div>
                    `;
                    document.getElementById('navigation-controls').classList.add('hidden');
                }
            };

            // --- ì´ˆê¸°í™” ë° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ---
            const init = () => {
                const week = getWeekNumber();
                // ë§¤ì£¼ ë‹¤ë¥¸ ë‹¨ì–´ ì„¸íŠ¸ë¥¼ ë³´ì—¬ì£¼ê¸° ìœ„í•´ ì£¼ì°¨ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë‹¨ì–´ ëª©ë¡ì„ ìë¦„
                const startIndex = ((week - 1) * WORDS_PER_WEEK) % ALL_WORDS.length;
                
                // ë‹¨ì–´ ëª©ë¡ì´ ìˆœí™˜ë˜ë„ë¡ ì²˜ë¦¬
                let tempWords = [];
                for(let i = 0; i < WORDS_PER_WEEK; i++) {
                    tempWords.push(ALL_WORDS[(startIndex + i) % ALL_WORDS.length]);
                }
                weeklyWords = tempWords;

                loadProgress();
                updateProgressView();

                // ë©”ë‰´ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
                document.querySelectorAll('.menu-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        switchMode(e.target.dataset.mode);
                    });
                });

                // ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
                document.getElementById('prev-btn').addEventListener('click', goToPrev);
                document.getElementById('next-btn').addEventListener('click', goToNext);
            };

            // ì•± ì‹œì‘
            init();
        });
    </script>
</body>
</html>